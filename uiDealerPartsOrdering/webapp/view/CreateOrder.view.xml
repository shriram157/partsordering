<mvc:View controllerName="tci.wave2.ui.parts.ordering.controller.CreateOrder" xmlns:html="http://www.w3.org/1999/xhtml"	
xmlns:core="sap.ui.core"  xmlns:mvc="sap.ui.core.mvc" xmlns:form="sap.ui.layout.form" xmlns:layout="sap.ui.layout" 
displayBlock="true" xmlns="sap.m">
	<Page showNavButton="false" floatingFooter="fasle" enableScrolling = 'false'>
		<customHeader>
			<core:Fragment fragmentName="tci.wave2.ui.parts.ordering.view.fragments.TopHeader" type="XML"/>
		</customHeader>	
		<core:Fragment fragmentName="tci.wave2.ui.parts.ordering.view.fragments.ToolHeader" type="XML"/>

		<ObjectHeader
			binding="{orderModel>/}"
			responsive="true"
			title="{orderModel>orderTypeName} -- {orderModel>/tciOrderNumber}"
			number="{orderModel>/totalLines}"
			numberUnit="{i18n>Lable.CreateOrder.OrderLines}" >
			<statuses>
			</statuses>
			<attributes>
				<ObjectAttribute
					title="{i18n>Lable.CreateOrder.CreateDate}"
					text="{path : 'orderModel>createDate',  formatter:'.formatter.shortDate'}"/>
				<ObjectAttribute
					title="{i18n>Lable.CreateOrder.ModifiedOn}"
					text="{path : 'orderModel>modifiedOn',  formatter:'.formatter.shortDate'}"/>
			</attributes>
		</ObjectHeader>
		
		<content>
		<!--
			<Panel >
				<content>
					<HBox alignItems="Stretch" justifyContent="Start">
						<VBox>
							<Label text="{i18n>Lable.CreateOrder.OrderType}"/>	
							<Input value="{orderModel>/orderTypeName}" width="90%" editable='false' />
						</VBox>
						<VBox>
							<Label text="{i18n>Lable.CreateOrder.OrderNumber}"/>	
							<Input value="{orderModel>/tciOrderNumber}" width="90%" editable='false' />
						</VBox>
						<VBox>
							<Label text="{i18n>Lable.CreateOrder.CreateDate}"/>									
							<DatePicker value="{
								path : 'orderModel>/createDate',
								type:'sap.ui.model.type.DateTime', 
								formatOptions: { format: 'yyyyMMMddHHmm', strictParsing: true }
								}" width="90%" editable='false' />
						</VBox>
						<VBox>
							<Label text="{i18n>Lable.CreateOrder.ModifiedOn}"/>									
							<DatePicker value="{
								path : 'orderModel>/createDate',
								type:'sap.ui.model.type.DateTime', 
								formatOptions: { format: 'yyyyMMMddHHmm', strictParsing: true }
								}" width="90%" editable='false' />
						</VBox>
						<VBox>
							<Label text="{i18n>Lable.CreateOrder.OrderLines}"/>									
							<Input value="{orderModel>/totalLines}" width="90%" editable='false' />
						</VBox>
					</HBox>
				</content>
			</Panel>
		-->
			<Table	id="idProductsTableHeader" 
					showNoData="false" 
					items="{orderModel>/newline}">
				<columns>
					<Column	width="40px" hAlign="Begin" >
						<Button  type='Reject' icon="sap-icon://delete" press='handleDeletePart' />
					</Column>
					<Column width="8rem" >
						<ObjectIdentifier title="{i18n>Lable.CreateOrder.PartNumber}" 
							text="{i18n>Lable.CreateOrder.Line}" />	
					</Column>
					<Column width="10rem" >
						<Text text="{i18n>Lable.CreateOrder.PartDesc}" />
					</Column>
					<Column width="3rem" >
						<Text text="{i18n>Lable.CreateOrder.SPQ}" />
					</Column>
					<Column width="6rem" >
						<Text text="{i18n>Lable.CreateOrder.qty}" />
					</Column>
					<Column>
						<Text text="{i18n>Lable.CreateOrder.Comment}" />
					</Column>
					<Column width="2rem"
						minScreenWidth="Tablet"
						demandPopin="true"
						hAlign="End">
						<Button id="addButton" type="Transparent" icon="sap-icon://cause"	press="onImport" />	
					</Column>
				</columns>
				<items>
					<ColumnListItem>
						<cells>
							<CheckBox select='toggleSelect'/>
							<Input	value="{orderModel>partNumber}" 
									type="Text"
									textFormatMode="Key"
									placeholder="{i18n>Placeholder.parts}"
									showSuggestion='true'
									suggest="handleSuggest"
									change='handleProductChange'
									startSuggestion="3"
									suggestionItems="{path: 'infoRecordModel>/C_Product_Fs', templateShareable:true}"
									maxSuggestionWidth = '500px'
									fieldWidth="auto" >
								<suggestionItems >
									<core:ListItem key="{infoRecordModel>Material}" text="{infoRecordModel>Material}" additionalText="{infoRecordModel>MaterialName}" />
								</suggestionItems>								
							</Input>	
							<Input value="{orderModel>partDesc}" enabled='false'/>
							<Input value="{path: 'orderModel>spq', formatter:'.formatter.spqFormat'}" enabled='false'/>
							<Input value="{orderModel>qty}" />
							<Input value="{orderModel>comment}" />
							<Button type='Transparent' icon="sap-icon://add" press='handleAddPart' ></Button>
						</cells>
					</ColumnListItem>
				</items>
			</Table>	
			<ScrollContainer id='flexContainer'
				height="{viewModel>/contHigh}"
				width="100%"
				horizontal="true"
				vertical="true"
				focusable="true">
				<Table id="idProductsTable"
					alternateRowColors="true"
					showNoData="false"
					mode='SingleSelectMaster'
					items="{
						path: 'orderModel>/items',
						sorter: [{
    								path: 'partNumber', 
        							descending: false
								 }, {
        							path: 'line', 
        							descending: false
    							 }]
					}">

					<columns>
						<Column width="40px" hAlign="Begin"/>
						<Column width="8rem" vAlign="Middle"/>
						<Column width="10rem" vAlign="Middle" />
						<Column width="3rem"  vAlign="Middle"/>
						<Column width="6rem" vAlign="Middle"/>
						<Column vAlign="Middle"/>
						<Column width="2rem" vAlign="Middle"
							minScreenWidth="Tablet"
							demandPopin="true"
							hAlign="End">
						</Column>
					</columns>
					<items>
						<ColumnListItem>
							<cells>
								<CheckBox selected='{orderModel>selected}' select='toggleRowSelect'/>
								<ObjectIdentifier title="{orderModel>partNumber}" 
									titleActive = 'true' titlePress='showDraftItemInfo'
									tooltip = "{parts: [{path: 'orderModel>uuid'}, {path: 'orderModel>parentUuid'}], formatter: '.formatter.getItemTooltip'}"
									text="{path: 'orderModel>line', formatter:'.formatter.lineNumberFormat' }" />	
								<Text text="{orderModel>partDesc}" />
								<Text text="{path: 'orderModel>spq', formatter:'.formatter.spqFormat'}" />
								<Input value="{orderModel>qty}" change='onQtyChange'/>
								<Input value="{orderModel>comment}" change='onCommentChange'/>
								<HBox justifyContent="End">
									<core:Icon src="sap-icon://e-care" color="#FC0519" press='handlePartMessage' visible="{=${orderModel>messageLevel} === 3}" />
									<core:Icon src="sap-icon://e-care" color="#FFDAB9" press='handlePartMessage' visible="{=${orderModel>messageLevel} === 2}" />
									<core:Icon src="sap-icon://e-care" color="#2DFA06" press='handlePartMessage' visible="{=${orderModel>messageLevel} === 1}" />
								</HBox>
							</cells>
						</ColumnListItem>
					</items>
				</Table>
				<Toolbar>
					<content>
						<Text text="" />
					</content>
				</Toolbar>
			</ScrollContainer>
		</content>
		<footer>
			<OverflowToolbar>
				<Button 
					icon="sap-icon://message-popup" 
                    text="{=${message>/}.length}"
                    visible="{=${message>/}.length > 0}"
					type="Emphasized" 
					press="handleMessagePopoverPress"/>
				<ToolbarSpacer/>
			
				<DraftIndicator id='draftInd'/>

				<ToolbarSpacer/>
				<Button type="Back" text="{i18n>Button.CreateOrder.Back}" press='onBack'/>					
				<Button type="Transparent" text="{i18n>Button.CreateOrder.ExportOrder}" press='onExport'/>
				<Button type="Reject" text="{i18n>Button.CreateOrder.DeleteOrder}" press='onDelete'/>
				<Button type="Accept" text="{i18n>Button.CreateOrder.SubmitOrder}" 	press='onActivate'/>
			</OverflowToolbar>
		</footer>
	</Page>			
</mvc:View>